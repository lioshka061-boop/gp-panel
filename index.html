<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zero-to-Bot Panel</title>
  <style>
    :root {
      color-scheme: light;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", sans-serif;
      --bg: #f7f9fc;
      --surface: #ffffff;
      --text: #0f172a;
      --muted: #667085;
      --line: #d8dee9;
      --blue: #4664ff;
      --cursor: #55a0ff;
      --green: #2ecc71;
      --danger: #ef4444;
      --shadow: 0 20px 45px -24px rgba(15, 23, 42, 0.4);
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    * { box-sizing: border-box; }

    .page {
      width: min(1100px, 100%);
      margin: 24px auto;
      background: var(--surface);
      border-radius: 18px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      min-height: 85vh;
    }

    header {
      padding: 20px 28px 12px;
      border-bottom: 1px solid var(--line);
    }

    header .top-line {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 16px;
    }

    .brand {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .brand .logo {
      width: 48px;
      height: 48px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      color: #fff;
      font-size: 20px;
      font-weight: 600;
      background: linear-gradient(120deg, var(--blue), #55a0ff);
    }

    .brand h1 {
      margin: 0;
      font-size: 20px;
    }

    .status-line {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .tag {
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      background: rgba(70, 100, 255, 0.1);
      color: var(--blue);
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    button, .btn {
      border: 1px solid var(--line);
      background: #fff;
      color: inherit;
      border-radius: 10px;
      padding: 10px 16px;
      font-size: 14px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button.primary, .btn.primary {
      border: none;
      color: #fff;
      background: linear-gradient(120deg, var(--blue), #55a0ff);
      font-weight: 600;
    }

    button.ghost, .btn.ghost {
      background: transparent;
    }

    button:disabled { opacity: 0.6; cursor: not-allowed; }
    button:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 0 10px 24px -18px rgba(15,23,42,0.45); }

    .progress {
      margin-top: 16px;
    }

    .progress-bar {
      height: 8px;
      background: rgba(70, 100, 255, 0.12);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-bar span {
      display: block;
      height: 100%;
      width: 0;
      border-radius: inherit;
      background: linear-gradient(120deg, var(--blue), #55a0ff);
      transition: width 0.4s ease;
    }

    main {
      flex: 1;
      padding: 32px 28px 40px;
    }

    main h2 {
      margin: 0 0 12px;
      font-size: 28px;
    }

    main p.lead {
      margin: 0 0 24px;
      color: var(--muted);
    }

    .grid {
      display: grid;
      gap: 16px;
    }

    .grid.two {
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }

    .grid.three {
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .card {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 18px;
      display: grid;
      gap: 12px;
      background: #fff;
    }

    .card.selected {
      border-color: var(--blue);
      box-shadow: 0 12px 32px -22px rgba(70, 100, 255, 0.6);
    }

    .card h3 {
      margin: 0;
      font-size: 18px;
    }

    .card p {
      margin: 0;
      color: var(--muted);
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .chip {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid var(--line);
      cursor: pointer;
      font-size: 14px;
    }

    .chip.active {
      background: rgba(70, 100, 255, 0.12);
      border-color: var(--blue);
      color: var(--blue);
      font-weight: 600;
    }

    .list {
      display: grid;
      gap: 10px;
    }

    .list .item {
      display: grid;
      gap: 6px;
    }

    label {
      font-weight: 600;
    }

    input[type="text"], textarea, select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--line);
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 44px;
      background: rgba(15, 23, 42, 0.02);
    }

    textarea.prompt {
      min-height: 180px;
      font-family: "JetBrains Mono", "Fira Code", ui-monospace, SFMono-Regular, Menlo, monospace;
      background: rgba(70, 100, 255, 0.08);
      border: 1px dashed rgba(70, 100, 255, 0.45);
    }

    .actions {
      margin-top: 28px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    footer {
      border-top: 1px solid var(--line);
      padding: 16px 28px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
      color: var(--muted);
      font-size: 13px;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 40;
      padding: 20px;
    }

    .modal {
      background: #fff;
      border-radius: 16px;
      max-width: 600px;
      width: min(600px, 100%);
      padding: 24px;
      display: grid;
      gap: 16px;
      position: relative;
      box-shadow: var(--shadow);
    }

    .modal h3 { margin: 0; }

    .modal .close {
      position: absolute;
      top: 16px;
      right: 16px;
      border-radius: 999px;
      width: 36px;
      height: 36px;
      display: grid;
      place-items: center;
      font-size: 18px;
      background: rgba(15, 23, 42, 0.08);
      cursor: pointer;
    }

    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: #fff;
      padding: 14px 18px;
      border-radius: 14px;
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      font-size: 14px;
      z-index: 50;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .hint {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
    }

    .checklist {
      display: grid;
      gap: 10px;
    }

    .check-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid var(--line);
    }

    .check-item strong { font-size: 15px; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(46, 204, 113, 0.12);
      color: #16a34a;
      font-size: 13px;
      font-weight: 600;
    }

    .chat-labels {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 13px;
    }

    .chat-labels span {
      display: inline-flex;
      gap: 6px;
      align-items: center;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(70, 100, 255, 0.12);
    }

    .chat-labels span.cursor {
      background: rgba(85, 160, 255, 0.16);
      color: var(--cursor);
      border: 1px solid rgba(85, 160, 255, 0.32);
    }

    .subtle {
      font-size: 14px;
      color: var(--muted);
    }

    @media (max-width: 720px) {
      header, main, footer { padding-left: 18px; padding-right: 18px; }
      .page { margin: 0; border-radius: 0; min-height: 100vh; }
    }
  </style>
</head>
<body>
  <div class="page" id="app">
    <header>
      <div class="top-line">
        <div class="brand">
          <div class="logo">ZB</div>
          <div>
            <h1>Zero-to-Bot Panel</h1>
            <div class="subtle" id="header-step">–°—Ç–∞—Ä—Ç</div>
          </div>
        </div>
        <div class="status-line">
          <div class="tag" id="mode-tag">–†–µ–∂–∏–º –Ω–µ –æ–±—Ä–∞–Ω–æ</div>
          <div class="tag" id="env-tag">–°–µ—Ä–µ–¥–æ–≤–∏—â–µ: ‚Äî</div>
        </div>
        <div class="controls">
          <button id="guide-btn">üìò –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä</button>
          <button id="help-btn">‚ùì –î–æ–ø–æ–º–æ–≥–∞</button>
          <button id="trouble-btn">üõ†Ô∏è –¢—Ä–∞–±–ª—à—É—Ç—ñ–Ω–≥</button>
          <button id="settings-btn">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
          <button id="reset-btn">‚ôªÔ∏è –°–∫–∏–Ω—É—Ç–∏</button>
        </div>
      </div>
      <div class="progress">
        <div class="subtle" id="progress-text">–ö—Ä–æ–∫ 1 —ñ–∑ 12</div>
        <div class="progress-bar"><span id="progress-bar"></span></div>
      </div>
    </header>
    <main>
      <h2 id="main-title">–°—Ç–∞—Ä—Ç</h2>
      <p class="lead" id="main-lead">–ó—Ä–æ–±–∏ —Å–≤–æ–≥–æ Telegram-–±–æ—Ç–∞ –±–µ–∑ –∫–æ–¥—É. –ü—Ä–æ—Å—Ç–æ –∫–æ–ø—ñ—é–π —ñ –≤—Å—Ç–∞–≤–ª—è–π –≥–æ—Ç–æ–≤—ñ –ø—ñ–¥–∫–∞–∑–∫–∏.</p>
      <div id="main-content"></div>
    </main>
    <footer>
      <div>üß≠ Chat 1: –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä ¬∑ üíª Chat 2: Cursor</div>
      <div>–ü—Ä–æ–≥—Ä–µ—Å –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ ¬∑ –í–µ—Ä—Å—ñ—è –ø–∞–Ω–µ–ª—ñ 0.1</div>
    </footer>
  </div>

  <div class="modal-backdrop" id="modal-backdrop" role="presentation">
    <div class="modal" id="generic-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <button class="close" id="modal-close" aria-label="–ó–∞–∫—Ä–∏—Ç–∏">√ó</button>
      <div id="modal-body"></div>
    </div>
  </div>

  <div class="toast" id="toast" role="status"></div>

  <script>
    const STORAGE_KEY = 'zeroToBotPanelState_v1';

    const clone = (value) => {
      if (typeof structuredClone === 'function') {
        return structuredClone(value);
      }
      return JSON.parse(JSON.stringify(value));
    };

    const defaultState = {
      version: 1,
      stepId: 'start',
      mode: null,
      environment: null,
      form: {
        role: '–ë–æ—Ç-–∞—Å–∏—Å—Ç–µ–Ω—Ç',
        goal: '',
        commands: '/start, /help, /add, /list, /done',
        language: 'uk',
        channel: 'dm'
      },
      config: {
        type: 'CRM',
        modules: ['/start', '/help'],
        storage: 'none',
        integrations: [],
        backend: 'none',
        complexity: 'L1'
      },
      prompts: {
        navigator: '',
        devBrief: '',
        cursor: '',
        checklist: ''
      },
      confirmed: false,
      checkpoints: {}
    };

    let state = loadState();

    const steps = [
      { id: 'start', title: '–°—Ç–∞—Ä—Ç', lead: '–ü–æ—è—Å–Ω–µ–Ω–Ω—è, —è–∫ —É—Å–µ –ø—Ä–∞—Ü—é—î, —Ç–∞ —Å—Ç–∞—Ä—Ç –ø—Ä–æ—Ü–µ—Å—É.', render: renderStart },
      { id: 'survey', title: '–ê–Ω–∫–µ—Ç–∞', lead: '–û–ø–∏—à–∏, —â–æ –º–∞—î —Ä–æ–±–∏—Ç–∏ —Ç–≤—ñ–π –±–æ—Ç. –ù–µ —Ö–≤–∏–ª—é–π—Å—è ‚Äî –º–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–º–æ —Ü–µ –Ω–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è.', render: renderSurvey },
      { id: 'mode', title: '–í–∏–±—ñ—Ä —Ä–µ–∂–∏–º—É', lead: '–í–∏–∑–Ω–∞—á, —è–∫ —Ö–æ—á–µ—à –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø—Ä–æ–º–ø—Ç–∏: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–±–æ —á–µ—Ä–µ–∑ –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–∞.', render: renderMode },
      { id: 'builder', title: '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–æ—Ç–∞', lead: '–ó–±–µ—Ä–∏ —Ç–µ—Ö–Ω—ñ—á–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é. –ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —ó—ó –¥–ª—è –ø—Ä–æ–º–ø—Ç—ñ–≤.', render: renderBuilder, guard: (s) => s.mode === 'auto' || !s.mode },
      { id: 'assisted-bridge', title: '–ü—ñ–¥–∫–∞–∑–∫–∞ –¥–ª—è –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–∞', lead: '–°–∫–æ–ø—ñ—é–π –ø—Ä–æ–º–ø—Ç —É ChatGPT, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–∏–π DEV BRIEF, –∞ –ø–æ—Ç—ñ–º –≤—Å—Ç–∞–≤ –π–æ–≥–æ —Å—é–¥–∏.', render: renderAssistedBridge, guard: (s) => s.mode === 'assisted' },
      { id: 'overview', title: '–û–≥–ª—è–¥ —ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è', lead: '–ü–µ—Ä–µ–≤—ñ—Ä DEV BRIEF —Ç–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π Cursor prompt. –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–µ—Ä–µ–π–¥–µ–º–æ –¥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.', render: renderOverview },
      { id: 'environment', title: '–í–∏–±—ñ—Ä —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞', lead: '–ü—Ä–∞—Ü—é–π –ª–æ–∫–∞–ª—å–Ω–æ –∞–±–æ –≤ Codespaces. –û–±–µ—Ä–∏, —â–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –±—ñ–ª—å—à–µ.', render: renderEnvironment },
      { id: 'tools', title: '–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤', lead: '–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—Å—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. –Ø–∫—â–æ —á–æ–≥–æ—Å—å –±—Ä–∞–∫—É—î ‚Äî –º–∏ –ø—ñ–¥–∫–∞–∂–µ–º–æ.', render: renderTools },
      { id: 'cursor', title: '–í—Å—Ç–∞–≤–∏—Ç–∏ —É Cursor', lead: '–°–∫–æ–ø—ñ—é–π —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –ø—Ä–æ–º–ø—Ç —Ç–∞ –≤—Å—Ç–∞–≤ —É Chat 2 (Cursor).', render: renderCursor },
      { id: 'launch', title: '–ó–∞–ø—É—Å–∫', lead: '–ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞: –≤—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –π –ø–µ—Ä–µ–≤—ñ—Ä —Ä–æ–±–æ—Ç—É –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ.', render: renderLaunch },
      { id: 'botfather', title: 'BotFather', lead: '–î–æ–¥–∞–π –∫–æ–º–∞–Ω–¥–∏ –¥–æ —Å–≤–æ–≥–æ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ BotFather.', render: renderBotFather },
      { id: 'test', title: '–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞', lead: '–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—Å–µ –ø—Ä–∞—Ü—é—î. –Ø–∫—â–æ —î –ø—Ä–æ–±–ª–µ–º–∞ ‚Äî –≤–∏–∫–ª–∏—á –¥–æ–ø–æ–º–æ–≥—É.', render: renderTest },
      { id: 'upgrade', title: '–ì–æ—Ç–æ–≤–æ –π –∞–ø“ë—Ä–µ–π–¥–∏', lead: '–ë–æ—Ç –ø—Ä–∞—Ü—é—î! –û–±–µ—Ä–∏, —á–∏ —Ö–æ—á–µ—à –¥–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∞–±–æ –æ–ø–ª–∞—Ç—É.', render: renderUpgrade }
    ];

    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return clone(defaultState);
        const parsed = JSON.parse(raw);
        return { ...clone(defaultState), ...parsed, form: { ...clone(defaultState.form), ...(parsed.form || {}) }, config: { ...clone(defaultState.config), ...(parsed.config || {}) }, prompts: { ...clone(defaultState.prompts), ...(parsed.prompts || {}) }, checkpoints: { ...(parsed.checkpoints || {}) } };
      } catch (err) {
        console.warn('Cannot load state', err);
        return clone(defaultState);
      }
    }

    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      } catch (err) {
        console.warn('Cannot save state', err);
      }
    }

    function resetState() {
      state = clone(defaultState);
      saveState();
      showToast('–ü—Ä–æ–≥—Ä–µ—Å —Å–∫–∏–Ω—É—Ç–æ. –ü–æ—á–∏–Ω–∞—î–º–æ —Å–ø–æ—á–∞—Ç–∫—É.');
      render();
    }

    function getVisibleSteps() {
      return steps.filter(step => !step.guard || step.guard(state));
    }

    function currentIndex() {
      const visible = getVisibleSteps();
      const idx = visible.findIndex(step => step.id === state.stepId);
      return idx === -1 ? 0 : idx;
    }

    function goToStep(stepId) {
      state.stepId = stepId;
      saveState();
      render();
    }

    function nextStep() {
      const visible = getVisibleSteps();
      const idx = currentIndex();
      const next = visible[idx + 1];
      if (next) {
        state.stepId = next.id;
        saveState();
        render();
      }
    }

    function prevStep() {
      const visible = getVisibleSteps();
      const idx = currentIndex();
      const prev = visible[idx - 1];
      if (prev) {
        state.stepId = prev.id;
        saveState();
        render();
      }
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2600);
    }

    function openModal(title, content) {
      document.getElementById('modal-body').innerHTML = `<h3 id="modal-title">${title}</h3>${content}`;
      const backdrop = document.getElementById('modal-backdrop');
      backdrop.style.display = 'flex';
    }

    function closeModal() {
      const backdrop = document.getElementById('modal-backdrop');
      backdrop.style.display = 'none';
    }

    document.getElementById('modal-close').addEventListener('click', closeModal);
    document.getElementById('modal-backdrop').addEventListener('click', (event) => {
      if (event.target.id === 'modal-backdrop') closeModal();
    });

    document.getElementById('reset-btn').addEventListener('click', () => {
      if (confirm('–°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å —ñ –ø–æ—á–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É?')) resetState();
    });

    document.getElementById('help-btn').addEventListener('click', () => {
      openModal('–î–æ–ø–æ–º–æ–≥–∞', `
        <p>–ß–∞—Å—Ç—ñ –ø–∏—Ç–∞–Ω–Ω—è:</p>
        <ul>
          <li><b>–Ø–∫ –≤—Å—Ç–∞–≤–∏—Ç–∏ –ø—Ä–æ–º–ø—Ç?</b> –í—ñ–¥–∫—Ä–∏–π Cursor, —Å—Ç–≤–æ—Ä—é–π –Ω–æ–≤–∏–π Chat 2, –≤—Å—Ç–∞–≤ —Ç–µ–∫—Å—Ç —ñ –Ω–∞—Ç–∏—Å–Ω–∏ Run.</li>
          <li><b>–ë–æ—Ç –º–æ–≤—á–∏—Ç—å?</b> –ü–µ—Ä–µ–≤—ñ—Ä —Ç–µ—Ä–º—ñ–Ω–∞–ª. –Ø–∫—â–æ —î –ø–æ–º–∏–ª–∫–∞ ‚Äî –Ω–∞—Ç–∏—Å–Ω–∏ ¬´–ü—Ä–æ–±–ª–µ–º–∞?¬ª –Ω–∞ –µ—Ç–∞–ø—ñ –∑–∞–ø—É—Å–∫—É.</li>
          <li><b>–í—Ç—Ä–∞—á–µ–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å?</b> –ü–∞–Ω–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î –∫—Ä–æ–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ –∫–æ–∂–Ω—ñ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥.</li>
        </ul>
      `);
    });

    document.getElementById('trouble-btn').addEventListener('click', () => {
      openModal('–¢—Ä–∞–±–ª—à—É—Ç—ñ–Ω–≥', `
        <div class="list">
          <div class="item">
            <strong>ModuleNotFoundError</strong>
            <span class="hint">–£—Å—Ç–∞–Ω–æ–≤–∏ –±—Ä–∞–∫–æ–≤–∞–Ω—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É: <code>pip install ...</code></span>
          </div>
          <div class="item">
            <strong>InvalidToken</strong>
            <span class="hint">–ü–µ—Ä–µ–≤—ñ—Ä —Ñ–∞–π–ª <code>.env</code> —ñ –æ–Ω–æ–≤–∏ —Ç–æ–∫–µ–Ω –≤—ñ–¥ BotFather.</span>
          </div>
          <div class="item">
            <strong>–ë–æ—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î</strong>
            <span class="hint">–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω–æ, –∞ –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –Ω–µ–º–∞—î Traceback.</span>
          </div>
        </div>
      `);
    });

    document.getElementById('settings-btn').addEventListener('click', () => {
      openModal('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è', `
        <div class="list">
          <label>–ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</label>
          <select id="settings-lang">
            <option value="uk" ${state.form.language === 'uk' ? 'selected' : ''}>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
            <option value="en" ${state.form.language === 'en' ? 'selected' : ''}>English (beta)</option>
          </select>
          <label>–°–µ—Ä–µ–¥–æ–≤–∏—â–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º</label>
          <select id="settings-env">
            <option value="local" ${state.environment === 'local' ? 'selected' : ''}>Local</option>
            <option value="codespaces" ${state.environment === 'codespaces' ? 'selected' : ''}>Codespaces</option>
            <option value="" ${!state.environment ? 'selected' : ''}>–ù–µ –≤–∏–±—Ä–∞–Ω–æ</option>
          </select>
          <div class="hint">–¶—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂—É—Ç—å—Å—è –π –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö –∫—Ä–æ–∫–∞—Ö.</div>
          <div class="actions">
            <button class="primary" id="settings-save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
          </div>
        </div>
      `);
      document.getElementById('settings-save').addEventListener('click', () => {
        const lang = document.getElementById('settings-lang').value;
        const env = document.getElementById('settings-env').value || null;
        state.form.language = lang;
        state.environment = env;
        saveState();
        closeModal();
        render();
        showToast('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ.');
      });
    });

    document.getElementById('guide-btn').addEventListener('click', () => {
      openModal('–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä', `
        <p>–¶–µ –∫–æ—Ä–æ—Ç–∫–∏–π –≥–∞–π–¥, —è–∫ —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ø–µ—Ä–µ–¥:</p>
        <ol>
          <li>–í–∏–∫–æ–Ω—É–π –∫—Ä–æ–∫–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ. –û–¥–∏–Ω –µ–∫—Ä–∞–Ω = –æ–¥–Ω–∞ –¥—ñ—è.</li>
          <li>–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç –≤—Å—Ç–∞–≤–ª—è–π —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —á–∞—Ç (üß≠ –∞–±–æ üíª).</li>
          <li>–Ø–∫—â–æ —â–æ—Å—å –Ω–µ –ø—Ä–∞—Ü—é—î ‚Äî —Ç–∏—Å–Ω–∏ ¬´–ü—Ä–æ–±–ª–µ–º–∞?¬ª —ñ –Ω–∞–¥—Å–∏–ª–∞–π –ª–æ–≥ —É –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä.</li>
        </ol>
        <p class="hint">–¶–µ–π –º–æ–¥—É–ª—å –º–æ–∂–Ω–∞ –∑–∞–ª–∏—à–∏—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º —É —Å—É—Å—ñ–¥–Ω—ñ–π –≤–∫–ª–∞–¥—Ü—ñ –∑ ChatGPT.</p>
      `);
    });

    function ensureNavigatorPrompt() {
      const { role, goal, commands, language, channel } = state.form;
      const configText = state.config.modules.length ? `–ö–æ–º–∞–Ω–¥–∏: ${state.config.modules.join(', ')}` : `–ö–æ–º–∞–Ω–¥–∏: ${commands}`;
      const channelText = channel === 'group' ? 'The bot will work inside Telegram groups.' : 'The bot will work in private chats.';
      const prompt = `You are an expert product owner. Help me craft a DEV BRIEF for a Telegram bot.\n` +
        `Role of the bot: ${role}.\n` +
        `Goal: ${goal || 'assist users with daily tasks'}.\n` +
        `${configText}.\n` +
        `${channelText}\n` +
        `Language of the interface: ${language.toUpperCase()}.\n` +
        `Return the brief in English with sections: Goal, Core commands, Data, Integrations, Success criteria.`;
      state.prompts.navigator = prompt;
      return prompt;
    }

    function ensureDevBrief() {
      if (state.mode === 'assisted') {
        return state.prompts.devBrief;
      }
      const { role, goal, commands, language, channel } = state.form;
      const { type, modules, storage, integrations, backend } = state.config;
      const mods = modules.length ? modules.join(', ') : commands;
      const integrationsText = integrations.length ? integrations.join(', ') : 'none';
      const storageText = storage === 'none' ? 'No persistent storage required.' : `Store data in ${storage}.`;
      const channelText = channel === 'group' ? 'The bot operates inside group chats.' : 'The bot operates in private chats (DM).';
      const brief = `Goal: Build a ${type.toLowerCase()} Telegram bot called "${role}" that ${goal || 'helps users manage their tasks'}.\n` +
        `Core commands: ${mods}.\n` +
        `User interface language: ${language.toUpperCase()}. ${channelText}\n` +
        `${storageText}\n` +
        `Integrations: ${integrationsText}. Backend module: ${backend === 'none' ? 'handled inside the bot without external service.' : backend}.\n` +
        `Success criteria: smooth onboarding via /start, help via /help, stable command handling without errors.`;
      state.prompts.devBrief = brief;
      return brief;
    }

    function ensureCursorPrompt() {
      const brief = ensureDevBrief();
      if (!brief) return '';
      const env = state.environment || 'local';
      const venv = env === 'codespaces' ? 'python3 -m venv .venv' : 'python -m venv .venv';
      const activate = env === 'codespaces' ? 'source .venv/bin/activate' : 'source .venv/bin/activate';
      const prompt = `You are an AI pair programmer inside Cursor. Using aiogram 3, generate a production-ready Telegram bot.\n` +
        `Project goals and constraints:\n${brief}\n` +
        `Expectations:\n- Create a structured project with src/ directory, splitting handlers, keyboards, and services.\n- Provide a README with launch instructions.\n- Use environment variables (.env) for BOT_TOKEN.\n- Include requirements.txt.\n- After generating code, remind me to run:${'\n  ' + venv}\n  ${activate}\n  pip install -r requirements.txt\n  python main.py.\n` +
        `Return the full code diff and any new files.`;
      state.prompts.cursor = prompt;
      return prompt;
    }

    function ensureChecklist() {
      const list = `1. Create virtual environment.\n2. Install dependencies with pip.\n3. Set BOT_TOKEN in .env.\n4. Run python main.py.\n5. Test /start and /help.\n6. Configure commands in BotFather.`;
      state.prompts.checklist = list;
      return list;
    }

    function copyToClipboard(text, label = '–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ') {
      if (!text) {
        showToast('–ù—ñ—á–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞—Ç–∏.');
        return;
      }
      navigator.clipboard.writeText(text).then(() => showToast(`${label}!`)).catch(() => showToast('–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏.'));
    }

    function renderStart(container) {
      container.innerHTML = `
        <div class="card">
          <h3>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!</h3>
          <p>–ü—Ä–æ–π–¥–∏ 12 –∫–æ—Ä–æ—Ç–∫–∏—Ö –∫—Ä–æ–∫—ñ–≤: –∫–æ–ø—ñ—é–π –ø—ñ–¥–∫–∞–∑–∫–∏, –≤—Å—Ç–∞–≤–ª—è–π —ó—Ö —É ChatGPT / Cursor —ñ –∑–∞–ø—É—Å–∫–∞–π –±–æ—Ç–∞.</p>
          <div class="actions">
            <button class="primary" id="start-go">–ü–æ—á–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</button>
            <button class="ghost" id="start-how">–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î?</button>
          </div>
        </div>
      `;
      container.querySelector('#start-go').addEventListener('click', () => {
        state.stepId = 'survey';
        saveState();
        render();
      });
      container.querySelector('#start-how').addEventListener('click', () => {
        openModal('–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î', `
          <div class="grid">
            <div class="card">
              <h3>1. –ó–∞–ø–æ–≤–Ω–∏ –∫–æ—Ä–æ—Ç–∫—É –∞–Ω–∫–µ—Ç—É</h3>
              <p>–ú–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è –±–µ–∑ —Å–∫–ª–∞–¥–Ω–∏—Ö —Ç–µ—Ä–º—ñ–Ω—ñ–≤.</p>
            </div>
            <div class="card">
              <h3>2. –°–∫–æ–ø—ñ—é–π –ø—Ä–æ–º–ø—Ç–∏ –≤ —á–∞—Ç–∏</h3>
              <p>–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä –¥–æ–ø–æ–º–∞–≥–∞—î –∑ DEV BRIEF, Cursor –ø–∏—à–µ –∫–æ–¥ –∑–∞ –∞–Ω–≥–ª–æ–º–æ–≤–Ω–∏–º–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏.</p>
            </div>
            <div class="card">
              <h3>3. –ó–∞–ø—É—Å—Ç–∏ —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç—É–π</h3>
              <p>–í–∏–∫–æ–Ω—É–π —á–µ–∫–ª—ñ—Å—Ç, –Ω–∞–ª–∞—à—Ç—É–π BotFather —ñ –ø–µ—Ä–µ–≤—ñ—Ä –∫–æ–º–∞–Ω–¥–∏ –ø—Ä—è–º–æ –≤ Telegram.</p>
            </div>
          </div>
        `);
      });
    }

    function renderSurvey(container) {
      const { role, goal, commands, language, channel } = state.form;
      container.innerHTML = `
        <form class="grid" id="survey-form">
          <div class="card">
            <div class="list">
              <div class="item">
                <label>–†–æ–ª—å –±–æ—Ç–∞</label>
                <input type="text" name="role" value="${role || ''}" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ê—Å–∏—Å—Ç–µ–Ω—Ç –∑–≤–∏—á–æ–∫" required />
              </div>
              <div class="item">
                <label>–©–æ –≤—ñ–Ω —Ä–æ–±–∏—Ç—å?</label>
                <textarea name="goal" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ω–∞–≥–∞–¥—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –ø—Ä–æ —â–æ–¥–µ–Ω–Ω—ñ –∑–≤–∏—á–∫–∏" required>${goal || ''}</textarea>
              </div>
              <div class="item">
                <label>–ö–æ–º–∞–Ω–¥–∏</label>
                <input type="text" name="commands" value="${commands}" />
                <div class="hint">–ú–æ–∂–µ—à –∑–∞–ª–∏—à–∏—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∞–±–æ –¥–æ–¥–∞—Ç–∏ —Å–≤–æ—ó.</div>
              </div>
              <div class="grid two">
                <div class="item">
                  <label>–ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</label>
                  <select name="language">
                    <option value="uk" ${language === 'uk' ? 'selected' : ''}>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                    <option value="en" ${language === 'en' ? 'selected' : ''}>English</option>
                  </select>
                </div>
                <div class="item">
                  <label>–ö–∞–Ω–∞–ª</label>
                  <select name="channel">
                    <option value="dm" ${channel === 'dm' ? 'selected' : ''}>–û—Å–æ–±–∏—Å—Ç—ñ —á–∞—Ç–∏</option>
                    <option value="group" ${channel === 'group' ? 'selected' : ''}>–ì—Ä—É–ø–∏</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="actions">
              <button type="submit" class="primary">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∞–Ω–∫–µ—Ç—É</button>
              ${state.mode === 'assisted' ? '<button type="button" class="btn" id="survey-copy">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–ª—è Chat 1</button>' : ''}
              <button type="button" class="ghost" id="survey-clear">–û—á–∏—Å—Ç–∏—Ç–∏ –ø–æ–ª—è</button>
              <button type="button" id="survey-back">–ù–∞–∑–∞–¥</button>
            </div>
          </div>
        </form>
      `;
      container.querySelector('#survey-form').addEventListener('submit', (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        state.form.role = formData.get('role');
        state.form.goal = formData.get('goal');
        state.form.commands = formData.get('commands');
        state.form.language = formData.get('language');
        state.form.channel = formData.get('channel');
        ensureNavigatorPrompt();
        ensureDevBrief();
        ensureCursorPrompt();
        ensureChecklist();
        saveState();
        showToast('–ê–Ω–∫–µ—Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∞. –†—É—Ö–∞—î–º–æ—Å—å –¥–∞–ª—ñ!');
        nextStep();
      });
      const copyBtn = container.querySelector('#survey-copy');
      if (copyBtn) {
        copyBtn.addEventListener('click', () => {
          const prompt = ensureNavigatorPrompt();
          copyToClipboard(prompt, '–ü—Ä–æ–º–ø—Ç –¥–ª—è –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–∞');
        });
      }
      container.querySelector('#survey-clear').addEventListener('click', () => {
        state.form = clone(defaultState.form);
        saveState();
        render();
      });
      container.querySelector('#survey-back').addEventListener('click', prevStep);
    }

    function renderMode(container) {
      container.innerHTML = `
        <div class="grid two">
          <div class="card">
            <h3>‚ö° AUTO ‚Äî –ø—Ä–æ—Å—Ç–∏–π —Ä–µ–∂–∏–º</h3>
            <p>–ü–∞–Ω–µ–ª—å —Å–∞–º–∞ —Å—Ç–≤–æ—Ä–∏—Ç—å DEV BRIEF —ñ —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –ø—Ä–æ–º–ø—Ç –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é.</p>
            <div class="actions">
              <button class="primary" id="mode-auto">–û–±—Ä–∞—Ç–∏ AUTO</button>
            </div>
          </div>
          <div class="card">
            <h3>üí¨ ASSISTED ‚Äî –∑ –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–æ–º</h3>
            <p>–û—Ç—Ä–∏–º–∞—î—à –ø—ñ–¥–∫–∞–∑–∫—É –¥–ª—è ChatGPT, –≤—ñ–Ω –¥–æ–ø–æ–º–æ–∂–µ –æ—Ñ–æ—Ä–º–∏—Ç–∏ DEV BRIEF –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é.</p>
            <div class="actions">
              <button class="primary" id="mode-assisted">–û–±—Ä–∞—Ç–∏ ASSISTED</button>
            </div>
          </div>
        </div>
        <div class="actions">
          <button id="mode-back">–ù–∞–∑–∞–¥</button>
        </div>
      `;
      container.querySelector('#mode-auto').addEventListener('click', () => {
        state.mode = 'auto';
        ensureDevBrief();
        ensureCursorPrompt();
        saveState();
        showToast('AUTO —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.');
        nextStep();
      });
      container.querySelector('#mode-assisted').addEventListener('click', () => {
        state.mode = 'assisted';
        ensureNavigatorPrompt();
        saveState();
        showToast('ASSISTED —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.');
        nextStep();
      });
      container.querySelector('#mode-back').addEventListener('click', prevStep);
    }

    function toggleInArray(list, value) {
      const idx = list.indexOf(value);
      if (idx >= 0) list.splice(idx, 1); else list.push(value);
    }

    function renderBuilder(container) {
      const config = state.config;
      container.innerHTML = `
        <div class="card">
          <h3>–û–±–µ—Ä–∏ —Ç–∏–ø –±–æ—Ç–∞</h3>
          <div class="chips" id="type-chips"></div>
        </div>
        <div class="card">
          <h3>–ú–æ–¥—É–ª—ñ —Ç–∞ –∫–æ–º–∞–Ω–¥–∏</h3>
          <div class="chips" id="module-chips"></div>
          <div class="hint">–ü–æ–∑–Ω–∞—á —É—Å—ñ –∫–æ–º–∞–Ω–¥–∏, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º.</div>
        </div>
        <div class="grid two">
          <div class="card">
            <h3>–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</h3>
            <div class="list" id="storage-radios"></div>
          </div>
          <div class="card">
            <h3>–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó</h3>
            <div class="chips" id="integration-toggles"></div>
          </div>
        </div>
        <div class="grid two">
          <div class="card">
            <h3>–ë–µ–∫–µ–Ω–¥</h3>
            <div class="chips" id="backend-chips"></div>
          </div>
          <div class="card">
            <h3>–†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ</h3>
            <div class="chips" id="level-chips"></div>
          </div>
        </div>
        <div class="actions">
          <button id="builder-back">–ù–∞–∑–∞–¥</button>
          <button class="primary" id="builder-next">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ ‚Üí –û–≥–ª—è–¥</button>
        </div>
      `;
      const typeOptions = ['CRM', 'Task Manager', 'Habit Tracker', 'FAQ', 'Shop', 'Booking', 'Custom'];
      const moduleOptions = ['/start', '/help', '/add', '/list', '/done', '/stats', '/tips', '/pay', '/admin'];
      const storageOptions = [
        { value: 'none', label: '–ë–µ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è' },
        { value: 'json', label: 'JSON —Ñ–∞–π–ª' },
        { value: 'google sheets', label: 'Google Sheets' },
        { value: 'sqlite', label: 'SQLite' },
        { value: 'postgres', label: 'Postgres' }
      ];
      const integrationOptions = ['Google Sheets', 'Notion', 'Webhook', 'Stripe', 'OpenAI'];
      const backendOptions = ['none', 'Parser', 'FastAPI', 'Webhook receiver'];
      const levels = ['L0', 'L1', 'L2', 'L3'];

      const typeContainer = container.querySelector('#type-chips');
      typeOptions.forEach(option => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip' + (config.type === option ? ' active' : '');
        btn.textContent = option;
        btn.addEventListener('click', () => {
          config.type = option;
          saveState();
          render();
        });
        typeContainer.appendChild(btn);
      });

      const moduleContainer = container.querySelector('#module-chips');
      moduleOptions.forEach(option => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip' + (config.modules.includes(option) ? ' active' : '');
        btn.textContent = option;
        btn.addEventListener('click', () => {
          toggleInArray(config.modules, option);
          saveState();
          render();
        });
        moduleContainer.appendChild(btn);
      });

      const storageContainer = container.querySelector('#storage-radios');
      storageOptions.forEach(option => {
        const label = document.createElement('label');
        label.className = 'chip' + (config.storage === option.value ? ' active' : '');
        label.style.cursor = 'pointer';
        label.textContent = option.label;
        label.addEventListener('click', () => {
          config.storage = option.value;
          saveState();
          render();
        });
        storageContainer.appendChild(label);
      });

      const integrationContainer = container.querySelector('#integration-toggles');
      integrationOptions.forEach(option => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip' + (config.integrations.includes(option) ? ' active' : '');
        btn.textContent = option;
        btn.addEventListener('click', () => {
          toggleInArray(config.integrations, option);
          saveState();
          render();
        });
        integrationContainer.appendChild(btn);
      });

      const backendContainer = container.querySelector('#backend-chips');
      backendOptions.forEach(option => {
        const label = option === 'none' ? '–ë–µ–∑ –±–µ–∫–µ–Ω–¥—É' : option;
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip' + (config.backend === option ? ' active' : '');
        btn.textContent = label;
        btn.addEventListener('click', () => {
          config.backend = option;
          saveState();
          render();
        });
        backendContainer.appendChild(btn);
      });

      const levelContainer = container.querySelector('#level-chips');
      levels.forEach(option => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip' + (config.complexity === option ? ' active' : '');
        btn.textContent = option;
        btn.addEventListener('click', () => {
          config.complexity = option;
          saveState();
          render();
        });
        levelContainer.appendChild(btn);
      });

      container.querySelector('#builder-back').addEventListener('click', prevStep);
      container.querySelector('#builder-next').addEventListener('click', () => {
        ensureDevBrief();
        ensureCursorPrompt();
        ensureChecklist();
        showToast('–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∑–±–µ—Ä–µ–∂–µ–Ω–æ.');
        nextStep();
      });
    }

    function renderAssistedBridge(container) {
      const prompt = ensureNavigatorPrompt();
      container.innerHTML = `
        <div class="card">
          <h3>1. –°–∫–æ–ø—ñ—é–π —É ChatGPT (–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä)</h3>
          <p>–í—Å—Ç–∞–≤ —Ü–µ–π —Ç–µ–∫—Å—Ç —É Chat 1, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–∏–π DEV BRIEF.</p>
          <textarea class="prompt" readonly id="navigator-prompt">${prompt}</textarea>
          <div class="actions">
            <button class="primary" id="copy-nav">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–ª—è Chat 1</button>
          </div>
        </div>
        <div class="card">
          <h3>2. –í—Å—Ç–∞–≤ DEV BRIEF –Ω–∞–∑–∞–¥ —É –ø–∞–Ω–µ–ª—å</h3>
          <textarea class="prompt" id="dev-brief-input" placeholder="–í—Å—Ç–∞–≤ —Å—é–¥–∏ –∞–Ω–≥–ª–æ–º–æ–≤–Ω–∏–π DEV BRIEF –≤—ñ–¥ ChatGPT">${state.prompts.devBrief || ''}</textarea>
          <div class="actions">
            <button id="assisted-back">–ù–∞–∑–∞–¥</button>
            <button class="primary" id="assisted-save">–ó–±–µ—Ä–µ–≥—Ç–∏ DEV BRIEF</button>
          </div>
        </div>
      `;
      container.querySelector('#copy-nav').addEventListener('click', () => copyToClipboard(prompt, '–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –¥–ª—è Chat 1'));
      container.querySelector('#assisted-back').addEventListener('click', prevStep);
      container.querySelector('#assisted-save').addEventListener('click', () => {
        const value = container.querySelector('#dev-brief-input').value.trim();
        if (!value) {
          showToast('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤ DEV BRIEF.');
          return;
        }
        state.prompts.devBrief = value;
        ensureCursorPrompt();
        ensureChecklist();
        saveState();
        showToast('DEV BRIEF –∑–±–µ—Ä–µ–∂–µ–Ω–æ.');
        nextStep();
      });
    }

    function renderOverview(container) {
      const devBrief = ensureDevBrief();
      const cursorPrompt = ensureCursorPrompt();
      const checklist = ensureChecklist();
      container.innerHTML = `
        <div class="grid">
          <div class="card">
            <div class="chat-labels"><span>üß≠ Chat 1</span><span class="cursor">üíª Chat 2</span></div>
            <h3>DEV BRIEF</h3>
            <textarea class="prompt" readonly id="brief-text">${devBrief || ''}</textarea>
            <div class="actions">
              <button class="ghost" id="copy-brief">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ DEV BRIEF</button>
            </div>
          </div>
          <div class="card">
            <h3>Cursor Prompt</h3>
            <textarea class="prompt" readonly id="cursor-text">${cursorPrompt}</textarea>
            <div class="actions">
              <button class="primary" id="copy-cursor">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–ª—è Cursor</button>
            </div>
          </div>
          <div class="card">
            <h3>Checklist –ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏</h3>
            <textarea class="prompt" readonly id="checklist-text">${checklist}</textarea>
            <div class="actions">
              <button class="ghost" id="copy-checklist">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —á–µ–∫–ª—ñ—Å—Ç</button>
              <button class="primary" id="overview-confirm">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –ø–ª–∞–Ω</button>
              <button id="overview-back">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫</button>
            </div>
          </div>
        </div>
      `;
      container.querySelector('#copy-brief').addEventListener('click', () => copyToClipboard(devBrief, 'DEV BRIEF —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#copy-cursor').addEventListener('click', () => copyToClipboard(cursorPrompt, 'Cursor prompt —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#copy-checklist').addEventListener('click', () => copyToClipboard(checklist, '–ß–µ–∫–ª—ñ—Å—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#overview-confirm').addEventListener('click', () => {
        state.confirmed = true;
        saveState();
        showToast('‚úÖ –ü–ª–∞–Ω –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ');
        nextStep();
      });
      container.querySelector('#overview-back').addEventListener('click', prevStep);
    }

    function renderEnvironment(container) {
      const env = state.environment;
      container.innerHTML = `
        <div class="grid two">
          <div class="card ${env === 'local' ? 'selected' : ''}">
            <h3>üíª Local</h3>
            <p>–ü—Ä–∞—Ü—é—î—à –Ω–∞ —Å–≤–æ—î–º—É –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ. –ü–æ—Ç—Ä—ñ–±–µ–Ω Python 3.10+ —ñ Cursor.</p>
            <div class="actions"><button class="primary" id="env-local">–û–±—Ä–∞—Ç–∏ Local</button><button class="ghost" data-info="local">–©–æ —Ü–µ?</button></div>
          </div>
          <div class="card ${env === 'codespaces' ? 'selected' : ''}">
            <h3>‚òÅÔ∏è Codespaces</h3>
            <p>–í—Å–µ –ø—Ä–∞—Ü—é—î –≤ –±—Ä–∞—É–∑–µ—Ä—ñ. –î–æ—Å—Ç–∞—Ç–Ω—å–æ GitHub-–∞–∫–∞—É–Ω—Ç–∞.</p>
            <div class="actions"><button class="primary" id="env-codespaces">–û–±—Ä–∞—Ç–∏ Codespaces</button><button class="ghost" data-info="codespaces">–©–æ —Ü–µ?</button></div>
          </div>
        </div>
        <div class="actions">
          <button id="env-back">–ù–∞–∑–∞–¥</button>
        </div>
      `;
      container.querySelector('#env-local').addEventListener('click', () => {
        state.environment = 'local';
        ensureCursorPrompt();
        saveState();
        showToast('Local —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –æ–±—Ä–∞–Ω–æ.');
        nextStep();
      });
      container.querySelector('#env-codespaces').addEventListener('click', () => {
        state.environment = 'codespaces';
        ensureCursorPrompt();
        saveState();
        showToast('Codespaces —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –æ–±—Ä–∞–Ω–æ.');
        nextStep();
      });
      container.querySelector('#env-back').addEventListener('click', prevStep);
      container.querySelectorAll('button[data-info]').forEach(btn => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.info;
          if (mode === 'local') {
            openModal('Local —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ', '<p>–ó–∞–ø—É—Å–∫–∞—î—à –±–æ—Ç–∞ –Ω–∞ —Å–≤–æ—î–º—É –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ. –ü–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Python 3.10+, —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥—É —Ç–∞ Cursor.</p>');
          } else {
            openModal('Codespaces', '<p>GitHub Codespaces –≤—ñ–¥–∫—Ä–∏–≤–∞—î –≥–æ—Ç–æ–≤–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ. –£—Å–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ: –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ Run.</p>');
          }
        });
      });
    }

    function renderTools(container) {
      const isCodespaces = state.environment === 'codespaces';
      container.innerHTML = `
        <div class="grid">
          <div class="card">
            <h3>–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—Å–µ –≥–æ—Ç–æ–≤–æ</h3>
            <div class="checklist">
              <div class="check-item"><span class="badge">1</span><div><strong>Python ${isCodespaces ? '–≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' : '3.10+'}</strong><div class="hint">${isCodespaces ? 'Codespaces –º—ñ—Å—Ç–∏—Ç—å Python –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.' : '–ó–∞–≤–∞–Ω—Ç–∞–∂ –∑ python.org —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º.'}</div></div></div>
              <div class="check-item"><span class="badge">2</span><div><strong>Cursor IDE</strong><div class="hint">–í—ñ–¥–∫—Ä–∏–π Cursor, –∞–≤—Ç–æ—Ä–∏–∑—É–π—Å—è —á–µ—Ä–µ–∑ GitHub —ñ —Å—Ç–≤–æ—Ä–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç.</div></div></div>
              ${isCodespaces ? '' : '<div class="check-item"><span class="badge">3</span><div><strong>Git –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</strong><div class="hint">–ü–µ—Ä–µ–≤—ñ—Ä –∫–æ–º–∞–Ω–¥–æ—é <code>git --version</code>. –¶–µ –¥–æ–ø–æ–º–æ–∂–µ –∫–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π.</div></div></div>'}
              <div class="check-item"><span class="badge">${isCodespaces ? '3' : '4'}</span><div><strong>VS Code (–æ–ø—Ü—ñ–π–Ω–æ)</strong><div class="hint">–ú–æ–∂–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ VS Code –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –ø–æ—Ä—É—á —ñ–∑ Cursor.</div></div></div>
            </div>
            <div class="actions">
              ${isCodespaces ? '<button class="primary" id="open-codespaces">–í—ñ–¥–∫—Ä–∏—Ç–∏ Codespaces</button>' : '<button class="primary" id="download-python">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Python</button>'}
              <button class="ghost" id="open-cursor">–í—ñ–¥–∫—Ä–∏—Ç–∏ Cursor</button>
              <button class="ghost" id="open-vscode">–í—ñ–¥–∫—Ä–∏—Ç–∏ VS Code</button>
              <button id="tools-back">–ù–∞–∑–∞–¥</button>
              <button class="primary" id="tools-next">–ü–µ—Ä–µ–≤—ñ—Ä–∏–≤, —É—Å–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚úÖ</button>
            </div>
          </div>
        </div>
      `;
      container.querySelector('#tools-back').addEventListener('click', prevStep);
      container.querySelector('#tools-next').addEventListener('click', () => {
        showToast('–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –≥–æ—Ç–æ–≤—ñ. –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫!');
        nextStep();
      });
      const openCursor = container.querySelector('#open-cursor');
      if (openCursor) openCursor.addEventListener('click', () => window.open('https://cursor.sh/', '_blank'));
      const openVSCode = container.querySelector('#open-vscode');
      if (openVSCode) openVSCode.addEventListener('click', () => window.open('https://code.visualstudio.com/', '_blank'));
      const downloadPython = container.querySelector('#download-python');
      if (downloadPython) downloadPython.addEventListener('click', () => window.open('https://www.python.org/downloads/', '_blank'));
      const openCodespaces = container.querySelector('#open-codespaces');
      if (openCodespaces) openCodespaces.addEventListener('click', () => window.open('https://github.com/codespaces', '_blank'));
    }

    function renderCursor(container) {
      const prompt = ensureCursorPrompt();
      container.innerHTML = `
        <div class="card">
          <div class="chat-labels"><span class="cursor">üíª Chat 2 ‚Äî Cursor</span></div>
          <h3>–°–∫–æ–ø—ñ—é–π —Ü–µ–π –ø—Ä–æ–º–ø—Ç —É Cursor (Chat 2)</h3>
          <textarea class="prompt" readonly id="cursor-copy-text">${prompt}</textarea>
          <div class="hint">–í—ñ–¥–∫—Ä–∏–π Cursor, —Å—Ç–≤–æ—Ä–∏ —á–∞—Ç —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó —Ç–∞ –≤—Å—Ç–∞–≤ —Ü–µ–π —Ç–µ–∫—Å—Ç.</div>
          <div class="actions">
            <button class="primary" id="cursor-copy">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–ª—è Cursor</button>
            <button id="cursor-guide">–î–µ –≤—Å—Ç–∞–≤–∏—Ç–∏?</button>
            <button id="cursor-back">–ù–∞–∑–∞–¥</button>
            <button class="primary" id="cursor-done">–í—Å—Ç–∞–≤–∏–≤ ‚Äî –¥–∞–ª—ñ</button>
          </div>
        </div>
      `;
      container.querySelector('#cursor-copy').addEventListener('click', () => copyToClipboard(prompt, '–ü—Ä–æ–º–ø—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#cursor-guide').addEventListener('click', () => {
        openModal('–î–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ –ø—Ä–æ–º–ø—Ç?', '<p>–£ Cursor –≤—ñ–¥–∫—Ä–∏–π –ø—Ä–æ—î–∫—Ç ‚Üí Chat ‚Üí –Ω–∞—Ç–∏—Å–Ω–∏ ¬´New chat¬ª ‚Üí –≤—Å—Ç–∞–≤ –ø—Ä–æ–º–ø—Ç ‚Üí –Ω–∞—Ç–∏—Å–Ω–∏ Run.</p>');
      });
      container.querySelector('#cursor-back').addEventListener('click', prevStep);
      container.querySelector('#cursor-done').addEventListener('click', () => {
        showToast('–ß—É–¥–æ–≤–æ! –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ –∑–∞–ø—É—Å–∫—É.');
        nextStep();
      });
    }

    function renderLaunch(container) {
      const commands = state.environment === 'codespaces'
        ? `python3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.txt\npython main.py`
        : `python -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.txt\npython main.py`;
      container.innerHTML = `
        <div class="card">
          <h3>–ö–æ–º–∞–Ω–¥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫—É</h3>
          <textarea class="prompt" readonly id="launch-text">${commands}</textarea>
          <div class="actions">
            <button class="primary" id="launch-copy">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏</button>
            <button class="ghost" id="launch-problem">–Ñ –ø—Ä–æ–±–ª–µ–º–∞</button>
            <button id="launch-back">–ù–∞–∑–∞–¥</button>
            <button class="primary" id="launch-done">–ó–∞–ø—É—Å—Ç–∏–≤</button>
          </div>
        </div>
      `;
      container.querySelector('#launch-copy').addEventListener('click', () => copyToClipboard(commands, '–ö–æ–º–∞–Ω–¥–∏ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#launch-problem').addEventListener('click', () => {
        openModal('–©–æ —Å–∞–º–µ –Ω–µ –ø—Ä–∞—Ü—é—î?', `
          <div class="list">
            <button class="btn" data-problem="python">Python –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</button>
            <button class="btn" data-problem="token">–ü–æ–º–∏–ª–∫–∞ —Ç–æ–∫–µ–Ω–∞</button>
            <button class="btn" data-problem="silence">–ë–æ—Ç –º–æ–≤—á–∏—Ç—å</button>
          </div>
        `);
        document.querySelectorAll('[data-problem]').forEach(btn => {
          btn.addEventListener('click', () => {
            const type = btn.dataset.problem;
            let message = '';
            if (type === 'python') {
              message = '–ü–µ—Ä–µ–≤—ñ—Ä, —á–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ Python —Ç–∞ –¥–æ–¥–∞–Ω–æ –¥–æ PATH. –ú–æ–∂–µ—à –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—é –≤–µ—Ä—Å—ñ—é –∑ python.org.';
            } else if (type === 'token') {
              message = '–í—ñ–¥–∫—Ä–∏–π .env, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ BOT_TOKEN=... —ñ —Ç–æ–∫–µ–Ω –∞–∫—Ç—É–∞–ª—å–Ω–∏–π. –Ø–∫—â–æ —Å—É–º–Ω—ñ–≤–∞—î—à—Å—è ‚Äî –æ—Ç—Ä–∏–º–∞–π –Ω–æ–≤–∏–π —É BotFather.';
            } else {
              message = '–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Å–∫—Ä–∏–ø—Ç main.py –ø—Ä–∞—Ü—é—î –±–µ–∑ –ø–æ–º–∏–ª–æ–∫. –Ø–∫—â–æ –±–æ—Ç –º–æ–≤—á–∏—Ç—å, –ø–µ—Ä–µ–≥–ª—è–Ω—å –æ—Å—Ç–∞–Ω–Ω—ñ –ª–æ–≥–∏ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤ —ó—Ö —É –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä.';
            }
            copyToClipboard(`Navigator, help me: ${message}`, '–ó–∞–ø–∏—Ç –¥–æ –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–∞ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ');
            closeModal();
            showToast('–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –ù–∞–≤—ñ–≥–∞—Ç–æ—Ä–∞ –≥–æ—Ç–æ–≤–µ.');
          });
        });
      });
      container.querySelector('#launch-back').addEventListener('click', prevStep);
      container.querySelector('#launch-done').addEventListener('click', () => {
        showToast('–ó–∞–ø—É—Å–∫ –≤–∏–∫–æ–Ω–∞–Ω–æ.');
        nextStep();
      });
    }

    function renderBotFather(container) {
      const commands = `/start - –ü–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É\n/help - –î–æ–ø–æ–º–æ–≥–∞\n/add - –î–æ–¥–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç\n/list - –ü–æ–∫–∞–∑–∞—Ç–∏ —Å–ø–∏—Å–æ–∫\n/done - –ü–æ–∑–Ω–∞—á–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏–º`;
      container.innerHTML = `
        <div class="card">
          <h3>–ö–æ–º–∞–Ω–¥–∏ –¥–ª—è BotFather</h3>
          <textarea class="prompt" readonly id="botfather-text">${commands}</textarea>
          <div class="actions">
            <button class="primary" id="botfather-copy">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏</button>
            <button id="botfather-open">–í—ñ–¥–∫—Ä–∏—Ç–∏ BotFather</button>
            <button id="botfather-back">–ù–∞–∑–∞–¥</button>
            <button class="primary" id="botfather-done">–ö–æ–º–∞–Ω–¥–∏ –¥–æ–¥–∞–Ω–æ</button>
          </div>
        </div>
      `;
      container.querySelector('#botfather-copy').addEventListener('click', () => copyToClipboard(commands, '–ö–æ–º–∞–Ω–¥–∏ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'));
      container.querySelector('#botfather-open').addEventListener('click', () => window.open('https://t.me/BotFather', '_blank'));
      container.querySelector('#botfather-back').addEventListener('click', prevStep);
      container.querySelector('#botfather-done').addEventListener('click', () => {
        showToast('–ö–æ–º–∞–Ω–¥–∏ –¥–æ–¥–∞–Ω–æ. –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏.');
        nextStep();
      });
    }

    function renderTest(container) {
      container.innerHTML = `
        <div class="card">
          <h3>–ß–µ–∫–ª—ñ—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏</h3>
          <div class="checklist">
            <div class="check-item"><span class="badge">1</span><div><strong>/start –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î?</strong><div class="hint">–ù–∞–¥—ñ—à–ª–∏ /start —Ç–∞ –¥–æ—á–µ–∫–∞–π—Å—è –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫ —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ.</div></div></div>
            <div class="check-item"><span class="badge">2</span><div><strong>/help –ø–æ–∫–∞–∑—É—î –∫–æ–º–∞–Ω–¥–∏?</strong><div class="hint">–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –ø–ª–∞–Ω—É.</div></div></div>
            <div class="check-item"><span class="badge">3</span><div><strong>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏ –ø—Ä–∞—Ü—é—é—Ç—å</strong><div class="hint">–ü–µ—Ä–µ–≤—ñ—Ä /add, /list —Ç–∞ —ñ–Ω—à—ñ –º–æ–¥—É–ª—ñ, —è–∫—ñ –æ–±—Ä–∞–≤.</div></div></div>
          </div>
          <div class="actions">
            <button class="ghost" id="test-problem">–Ñ –ø—Ä–æ–±–ª–µ–º–∞</button>
            <button id="test-back">–ù–∞–∑–∞–¥</button>
            <button class="primary" id="test-done">–í—Å–µ –ø—Ä–∞—Ü—é—î</button>
          </div>
        </div>
      `;
      container.querySelector('#test-problem').addEventListener('click', () => {
        openModal('–©–æ —Ç—Ä–∞–ø–∏–ª–æ—Å—å?', '<p>–ó–±–µ—Ä–µ–∂–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 50 —Ä—è–¥–∫—ñ–≤ –ª–æ–≥—ñ–≤ —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ¬´–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä¬ª. –í—ñ–Ω –¥–æ–ø–æ–º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ –ø–æ–º–∏–ª–∫—É.</p>');
      });
      container.querySelector('#test-back').addEventListener('click', prevStep);
      container.querySelector('#test-done').addEventListener('click', () => {
        showToast('–í—ñ—Ç–∞—î–º–æ! –ë–æ—Ç –ø—Ä–∞—Ü—é—î.');
        nextStep();
      });
    }

    function renderUpgrade(container) {
      container.innerHTML = `
        <div class="grid three">
          <div class="card">
            <h3>üí¨ –ö–Ω–æ–ø–∫–∏ —Ç–∞ –º–µ–Ω—é</h3>
            <p>–î–æ–¥–∞–π Reply / Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–æ–º–∞–Ω–¥.</p>
            <div class="actions"><button class="primary" id="upgrade-ui">–•–æ—á—É –¥–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏</button></div>
          </div>
          <div class="card">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <p>–ü–æ–∫–∞–∑—É–π –ø—Ä–æ–≥—Ä–µ—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞–π —â–æ—Ç–∏–∂–Ω–µ–≤—ñ –¥–∞–π–¥–∂–µ—Å—Ç–∏.</p>
            <div class="actions"><button class="primary" id="upgrade-stats">–•–æ—á—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button></div>
          </div>
          <div class="card">
            <h3>üí∞ –û–ø–ª–∞—Ç–∏</h3>
            <p>–ü—Ä–∏–π–º–∞–π Telegram Stars –∞–±–æ Stripe –¥–ª—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü—ñ—ó.</p>
            <div class="actions"><button class="primary" id="upgrade-payments">–•–æ—á—É –æ–ø–ª–∞—Ç—É</button></div>
          </div>
        </div>
        <div class="actions">
          <button class="ghost" id="upgrade-home">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞ –≥–æ–ª–æ–≤–Ω—É</button>
        </div>
      `;
      container.querySelector('#upgrade-ui').addEventListener('click', () => showToast('–ú–æ–¥—É–ª—å –∫–Ω–æ–ø–æ–∫ —É —Ä–æ–∑—Ä–æ–±—Ü—ñ.'));
      container.querySelector('#upgrade-stats').addEventListener('click', () => showToast('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑‚Äô—è–≤–∏—Ç—å—Å—è —É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö.'));
      container.querySelector('#upgrade-payments').addEventListener('click', () => showToast('–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –æ–ø–ª–∞—Ç –≥–æ—Ç—É—î—Ç—å—Å—è.'));
      container.querySelector('#upgrade-home').addEventListener('click', () => {
        state.stepId = 'start';
        saveState();
        render();
      });
    }

    function render() {
      const visible = getVisibleSteps();
      if (!visible.find(step => step.id === state.stepId)) {
        state.stepId = visible[0].id;
      }
      const index = currentIndex();
      const step = visible[index];
      const mainTitle = document.getElementById('main-title');
      const mainLead = document.getElementById('main-lead');
      const headerStep = document.getElementById('header-step');
      mainTitle.textContent = step.title;
      mainLead.textContent = step.lead;
      headerStep.textContent = step.title;

      const progressText = document.getElementById('progress-text');
      progressText.textContent = `–ö—Ä–æ–∫ ${index + 1} —ñ–∑ ${visible.length}`;
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = `${((index + 1) / visible.length) * 100}%`;

      const modeTag = document.getElementById('mode-tag');
      modeTag.textContent = state.mode ? `–†–µ–∂–∏–º: ${state.mode === 'auto' ? 'AUTO' : 'ASSISTED'}` : '–†–µ–∂–∏–º –Ω–µ –æ–±—Ä–∞–Ω–æ';
      const envTag = document.getElementById('env-tag');
      envTag.textContent = `–°–µ—Ä–µ–¥–æ–≤–∏—â–µ: ${state.environment ? (state.environment === 'codespaces' ? 'Codespaces' : 'Local') : '‚Äî'}`;

      const container = document.getElementById('main-content');
      container.innerHTML = '';
      step.render(container);
    }

    render();
    setInterval(saveState, 5000);
  </script>
</body>
</html>
